{% extends "core/base.html" %}
{% block title %}Main page{% endblock %}
{% block content %}
<h2>
  Questions
  <span>
    <a href="/?sort=date" {% if sort == 'date' %}class="active"{% endif %}>New</a> |
    <a href="/?sort=rating" {% if sort == 'rating' %}class="active"{% endif %}>Hot</a>
  </span>
</h2>

{% if user.is_authenticated %}
  <div class="ask-question-button" style="margin-top:10px;">
    <a href="{% url 'ask_question' %}" class="ask_button">Ask question</a>
  </div>
{% endif %}

<div class="questions-list">
  {% for question in new_questions %}
    <div class="question">
      <a href="{% url 'question' question.id %}" class="question-title">{{ question.title }}</a>
      <p class="question-content">{{ question.detailed }}</p>
      <p>Tags:
        {% for tag in question.tags.all %}
          <a href="{% url 'tag_page' tag.title %}" class="tag">{{ tag.title }}</a>
        {% empty %} No tags {% endfor %}
      </p>
      <p><a href="{% url 'question' question.id %}">Answers: {{ question.answer_set.count }}</a></p>
      <p>Rating: {{ question.rating }}</p>

      {% if user.is_authenticated %}
        <form method="post" action="{% url 'index' %}">
          {% csrf_token %}
          <input type="hidden" name="question_id" value="{{ question.id }}">
          <button type="submit" name="vote" value="up">+</button>
          <button type="submit" name="vote" value="down">-</button>
        </form>
      {% else %}
        <p>Login to vote</p>
      {% endif %}
    </div>
  {% endfor %}
</div>

{% if new_questions.paginator.num_pages > 1 %}
<div class="pagination">
    {% if new_questions.has_previous %}
        <a href="?page={{ new_questions.previous_page_number }}{% if sort %}&sort={{ sort }}{% endif %}">« Prev</a>
    {% endif %}

    {% for num in new_questions.paginator.page_range %}
        {% if num == new_questions.number %}
            <span class="current">{{ num }}</span>
        {% else %}
            <a href="?page={{ num }}{% if sort %}&sort={{ sort }}{% endif %}">{{ num }}</a>
        {% endif %}
    {% endfor %}

    {% if new_questions.has_next %}
        <a href="?page={{ new_questions.next_page_number }}{% if sort %}&sort={{ sort }}{% endif %}">Next »</a>
    {% endif %}
</div>
{% endif %}

{% endblock %}
