{% extends "core/base.html" %}
{% block title %}Questions with tag: "{{ tag.title }}"{% endblock %}

{% block content %}
<h2>Questions with tag: "{{ tag.title }}"</h2>

{% for question in questions %}
    <div class="question">
        <a href="{% url 'question' question.id %}" class="question-title">{{ question.title }}</a>
        <p class="question-content">{{ question.detailed|truncatechars:200 }}</p>
        <p>Author: {{ question.author.username }}</p>
        <p>Answers: {{ question.answer_set.count }}</p>
        <p>Tags:
            {% for tag in question.tags.all %}
                <a href="{% url 'tag_page' tag.title %}" class="tag">{{ tag.title }}</a>{% if not forloop.last %}, {% endif %}
            {% empty %}No tags{% endfor %}
        </p>
        <p>Rating: {{ question.rating }}</p>

        {% if user.is_authenticated %}
        <form method="post">
            {% csrf_token %}
            <input type="hidden" name="question_id" value="{{ question.id }}">
            <button type="submit" name="vote" value="up">+</button>
            <button type="submit" name="vote" value="down">−</button>
        </form>
        {% else %}
        <p>Login to vote</p>
        {% endif %}
    </div>
{% empty %}
<p>Пока нет вопросов с этим тегом.</p>
{% endfor %}

<div class="pagination">
  {% if questions.has_previous %}
    <a href="?page={{ questions.previous_page_number }}">« Prev</a>
  {% endif %}

  {% for num in questions.paginator.page_range %}
    {% if num == questions.number %}
      <span class="current">{{ num }}</span>
    {% else %}
      <a href="?page={{ num }}">{{ num }}</a>
    {% endif %}
  {% endfor %}

  {% if questions.has_next %}
    <a href="?page={{ questions.next_page_number }}">Next »</a>
  {% endif %}
</div>

{% endblock %}
